
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<style type="text/css">
			*{
				padding: 0;
				margin: 0;
			}
			.car_pic{
				width: 500px;
				height: 421px;
				/*border: 1px solid #000;*/
				margin-left: 100px;
				position: relative;
			}
			.car_pic ul{
				list-style: none;
			}
			.car_pic ul li.cur{display: block;}
			.car_pic ul li{
				display: none;
				width: 500px;
				height: 375px;
			}
			.car_pic ul li img{
				width: 500px;
				height: 375px;
			}
			.car_pic_ctr{
				width: 405px;
				height: 26px;
				line-height: 26px;
				font-size: 12px;
				margin: 0 auto;
				background: url(img/h1/car_pic_ctr.png) repeat-x 0 -26px;
			}
			.ctr_l{
				float: left;
				width: 0px;
				height: 26px;
				padding-left: 20px;
				background: url(img/h1/car_pic_ctr.png) no-repeat 0 0px;
			}
			.ctr_r{
				float: right;
				width: 0px;
				height: 26px;
				padding-right: 45px;
				background: url(img/h1/car_pic_ctr.png) no-repeat 25px -78px;
			}
			.ctr_center{
				float: left;
				width: 300px;
				height: 26px;
				background: url(img/h1/car_pic_ctr.png) repeat-x 0 -52px;
				margin: 0 20px;
				position: relative;
				cursor: pointer;
			}
			.ctr_center b{
				position: absolute;
				top: 0;
				left: 0;
				width: 21px;
				height: 26px;
				background: url(../img/car_pic_ctr.png) repeat-x 0 -104px;
			}
		</style>
	</head>
	<body>
		<div class="car_pic">
			<div class="imglist" id="imglist">
				<ul>
					<li class="cur"> <img src="../img/0.jpg"/> </li>
					<li> <img src="../img/1.jpg"/> </li>
					<li> <img src="../img/2.jpg"/> </li>
					<li> <img src="../img/3.jpg"/> </li>
					<li> <img src="../img/4.jpg"/> </li>
				</ul>
			</div>
			<div class="car_pic_ctr">
				<div class="ctr_l">0°</div>
				<div class="ctr_center" id="ctr_center">
					<b id="barB"></b>
				</div>
				<div class="ctr_r">180°</div>
			</div>
		</div>
		<script type="text/javascript">
			var barB=document.getElementById("barB");//滑块
			var ctr_center=document.getElementById("ctr_center");//滑道
			var imglistlis=document.getElementById("imglist").getElementsByTagName("li");
			//滑块的最大left的值
			var maxLeft=ctr_center.clientWidth-barB.clientWidth;
			var step=maxLeft/4;
			var idx=0;//对图片编号
			//拖拽模型
			barB.onmousedown=function(event){
				event=event||window.event;
				//计算点击瞬间的误差
				var deltaX=event.clientX-this.offsetLeft;
				document.onmousemove=function(event){
					event=event||window.event;
					//滑块此时应该在的位置
					var x=event.clientX-deltaX;
					//步长100
					x=parseInt(x/step)*step;
					if (x<0) {
						x=0;
					}else if(x>maxLeft){
						x=maxLeft;
					}
					//当信号量发生改变，滑块位置和原来的不一样
					if (idx!=parseInt(x/step)) {
						//让老的信号量的图去掉cur
						imglistlis[idx].className="";
						//信号量的改变
						idx=parseInt(x/step);
						//改变滑块的位置
						barB.style.left=x+"px";
						imglistlis[idx].className="cur";
					}
					return false;
				}
				document.onmouseup=function(){
					document.onmousemove=null;
				}
			}
			ctr_center.onmousedown=function(event){
				event=event||window.event;
				//鼠标点击的x的位置
				var x=event.clientX-getAllLeft(ctr_center);
				imglistlis[idx].className="";
				//信号量发生改变
				idx=Math.round(x/step);
				barB.style.left=idx*step+"px";
				imglistlis[idx].className="cur";
				
			}
			function getAllLeft(obj){
				//累加器  offsettop的值
				var allLeft=obj.offsetLeft;
				//当前正在计算高度的元素
				var currentObj=obj;
				while (currentObj=currentObj.offsetParent){
					allLeft+=currentObj.offsetLeft;
				}
				return allLeft;
			}
		</script>
	</body>
</html>
